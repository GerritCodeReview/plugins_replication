{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "6125772a_ca7a02d8",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/replication/PushOne.java",
        "patchSetId": 2
      },
      "lineNbr": 251,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2024-11-13T16:19:06Z",
      "side": 1,
      "message": "This would make two streams navigation: one at L251 and another at L252",
      "range": {
        "startLine": 251,
        "startChar": 0,
        "endLine": 251,
        "endChar": 71
      },
      "revId": "d88578276a309f74424e30b26d25a8bf62792d72",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "28aabd2a_8e0d8f9c",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/replication/PushOne.java",
        "patchSetId": 2
      },
      "lineNbr": 251,
      "author": {
        "id": 1149185
      },
      "writtenOn": "2024-11-13T16:49:26Z",
      "side": 1,
      "message": "I am aware of that. \nIs the data structure `Set\u003cImmutableSet\u003cString\u003e\u003e refs \u003d getRefs()` very big?",
      "parentUuid": "6125772a_ca7a02d8",
      "range": {
        "startLine": 251,
        "startChar": 0,
        "endLine": 251,
        "endChar": 71
      },
      "revId": "d88578276a309f74424e30b26d25a8bf62792d72",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "beb930ea_256a3297",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/replication/PushOne.java",
        "patchSetId": 2
      },
      "lineNbr": 251,
      "author": {
        "id": 1149185
      },
      "writtenOn": "2024-11-13T18:24:24Z",
      "side": 1,
      "message": "maybe we could use `refs.stream().mapToInt(Set::size).sum()` this operation only traverses the first level (batches). The size operation is a constant operation.\nOpen to suggestions.",
      "parentUuid": "28aabd2a_8e0d8f9c",
      "range": {
        "startLine": 251,
        "startChar": 0,
        "endLine": 251,
        "endChar": 71
      },
      "revId": "d88578276a309f74424e30b26d25a8bf62792d72",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "58c4ffd9_f92f99d1",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/replication/PushOne.java",
        "patchSetId": 2
      },
      "lineNbr": 251,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2024-11-14T09:16:14Z",
      "side": 1,
      "message": "I am wondering if we really need to pay that price that to say that there are more refs filtered out. The list of refs to push may be huge, even millions of entries.",
      "parentUuid": "beb930ea_256a3297",
      "range": {
        "startLine": 251,
        "startChar": 0,
        "endLine": 251,
        "endChar": 71
      },
      "revId": "d88578276a309f74424e30b26d25a8bf62792d72",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "bc8297f7_03de3153",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/replication/PushOne.java",
        "patchSetId": 2
      },
      "lineNbr": 251,
      "author": {
        "id": 1149185
      },
      "writtenOn": "2024-11-14T09:48:15Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "58c4ffd9_f92f99d1",
      "range": {
        "startLine": 251,
        "startChar": 0,
        "endLine": 251,
        "endChar": 71
      },
      "revId": "d88578276a309f74424e30b26d25a8bf62792d72",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "05f3f100_03c4121a",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/replication/PushOne.java",
        "patchSetId": 2
      },
      "lineNbr": 251,
      "author": {
        "id": 1149185
      },
      "writtenOn": "2024-11-14T10:13:37Z",
      "side": 1,
      "message": "I reopen this comment open. I added @matthias.sohn@gmail.com just to have another opinion.",
      "parentUuid": "bc8297f7_03de3153",
      "range": {
        "startLine": 251,
        "startChar": 0,
        "endLine": 251,
        "endChar": 71
      },
      "revId": "d88578276a309f74424e30b26d25a8bf62792d72",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "2ec236ce_dc4add8d",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/replication/PushOne.java",
        "patchSetId": 2
      },
      "lineNbr": 251,
      "author": {
        "id": 1004034
      },
      "writtenOn": "2024-11-14T11:55:06Z",
      "side": 1,
      "message": "I\u0027d try to avoid traversing all refs if possible. We have repos with millions of refs hosted on NFS, in case there are thousands of loose refs this will be very slow. I think it\u0027s more important to ensure good performance instead of ensuring the limit is enforced exactly on the configured number. Hence I would not count loose refs to enforce this limit.",
      "parentUuid": "05f3f100_03c4121a",
      "range": {
        "startLine": 251,
        "startChar": 0,
        "endLine": 251,
        "endChar": 71
      },
      "revId": "d88578276a309f74424e30b26d25a8bf62792d72",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "d4f73f0d_14f0ce03",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/replication/PushOne.java",
        "patchSetId": 2
      },
      "lineNbr": 251,
      "author": {
        "id": 1149185
      },
      "writtenOn": "2024-11-14T13:13:42Z",
      "side": 1,
      "message": "I removed the count of hidden refs.",
      "parentUuid": "2ec236ce_dc4add8d",
      "range": {
        "startLine": 251,
        "startChar": 0,
        "endLine": 251,
        "endChar": 71
      },
      "revId": "d88578276a309f74424e30b26d25a8bf62792d72",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "b0904ea2_05a1974f",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/replication/PushOne.java",
        "patchSetId": 2
      },
      "lineNbr": 257,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2024-11-13T16:19:06Z",
      "side": 1,
      "message": "Can the `collect(Collectors.joining(\" \"))` be dried out?",
      "range": {
        "startLine": 255,
        "startChar": 0,
        "endLine": 257,
        "endChar": 79
      },
      "revId": "d88578276a309f74424e30b26d25a8bf62792d72",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "d9bbc1ec_5eea148c",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/replication/PushOne.java",
        "patchSetId": 2
      },
      "lineNbr": 257,
      "author": {
        "id": 1149185
      },
      "writtenOn": "2024-11-13T16:38:25Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "b0904ea2_05a1974f",
      "range": {
        "startLine": 255,
        "startChar": 0,
        "endLine": 257,
        "endChar": 79
      },
      "revId": "d88578276a309f74424e30b26d25a8bf62792d72",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    }
  ]
}