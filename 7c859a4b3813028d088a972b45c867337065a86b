{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "8d5e402d_da11b054",
        "filename": "/COMMIT_MSG",
        "patchSetId": 6
      },
      "lineNbr": 16,
      "author": {
        "id": 1002666
      },
      "writtenOn": "2024-02-13T17:27:30Z",
      "side": 1,
      "message": "Thanks for pushing this change. Just to add to this point, I think we discovered this bullet as an issue for us because in one of our internal plugins we inject the injector and use it to get an instance of a module we want to install only when the plugin isn\u0027t running on a replica. That started failing when the replication plugin was updated in core to declare an ApiModule with an error about `@PluginName` already being bound.\n\nWe probably needs some tests in core for usage of `Gerrit-ApiModule`. Right now the `TestPlugin` interface doesn\u0027t even know about it.",
      "revId": "7c859a4b3813028d088a972b45c867337065a86b",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "eb0b1e89_6c90ca27",
        "filename": "/COMMIT_MSG",
        "patchSetId": 6
      },
      "lineNbr": 16,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2024-04-02T13:50:36Z",
      "side": 1,
      "message": "Acknowledged",
      "parentUuid": "8d5e402d_da11b054",
      "revId": "7c859a4b3813028d088a972b45c867337065a86b",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "e2d8488e_92c11492",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 6
      },
      "lineNbr": 0,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2024-02-10T22:43:21Z",
      "side": 1,
      "message": "Tested E2E and verified that:\n- replication plugin can always be reloaded, with or without the api extension\n- replication plugin with the api extension can be extended and still reloaded",
      "revId": "7c859a4b3813028d088a972b45c867337065a86b",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "b97eea74_ea244eab",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 6
      },
      "lineNbr": 0,
      "author": {
        "id": 1010134
      },
      "writtenOn": "2024-02-12T15:39:11Z",
      "side": 1,
      "message": "I do understand the reasoning behind this change, that it\u0027s fixing a regression introduced by adding `ApiModule`, and it\u0027s also the _simplest_ and _quickest_ way to fix that but...\n\nBut, one of the reasons why the `ApiModules` were introduced was to reduce the complexity of plugin deployment as it doesn\u0027t require plugin JARs being put in `lib/` and manual registration of `gerrit.installModule`. I feel that now we\u0027re adding even more complexity with a custom build target and an `replication-api.jar` in `plugins/`. This may lead to \"version mismatch\" when only the `replication.jar` will be updated.\n\nI get the reasoning behind it and also understand the technical limitations, but it doesn\u0027t feel good. üòê\n\nI don\u0027t have any better ideas, just wanted to be open about this, maybe someone will have a better idea for fixing this or maybe there\u0027s a better path forward.",
      "revId": "7c859a4b3813028d088a972b45c867337065a86b",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "00846c78_cc038048",
        "filename": "BUILD",
        "patchSetId": 6
      },
      "lineNbr": 22,
      "author": {
        "id": 1010134
      },
      "writtenOn": "2024-02-12T15:39:11Z",
      "side": 1,
      "message": "now the API classes will be loaded twice, once from the `replication-api.jar`, and a second time from `replicaiton.jar` (as the `replication` target does not exclude them). \n\nThis should not be a problem as long as both `replication-api.jar` and `replication.jar` are kept in the same version.",
      "revId": "7c859a4b3813028d088a972b45c867337065a86b",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "6e379257_dfcc1ea0",
        "filename": "BUILD",
        "patchSetId": 6
      },
      "lineNbr": 22,
      "author": {
        "id": 1003873
      },
      "writtenOn": "2024-02-13T10:32:24Z",
      "side": 1,
      "message": "Can it be avoided to load those classes twice? I also do not feel good about those classes being loaded twice but also do not have a good proposal what to do.",
      "parentUuid": "00846c78_cc038048",
      "revId": "7c859a4b3813028d088a972b45c867337065a86b",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "cd9f20fd_aeb710f5",
        "filename": "BUILD",
        "patchSetId": 6
      },
      "lineNbr": 22,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2024-04-02T13:28:01Z",
      "side": 1,
      "message": "\u003e Can it be avoided to load those classes twice? I also do not feel good about those classes being loaded twice but also do not have a good proposal what to do.\n\nWell, I would disagree that they are loaded twice:\n- classes are loaded from a class loader\n- the class loader of the replication.jar will be a child class loader of replication-api.jar\n- the JVM gets the class from the first class loader that it finds it, in this case replication-api.jar\n\nBottom line \u003d\u003e the classes in replication-api.jar will be loaded only once.\n\nYou can try with a Class.forName() and see that the class instance is the same.",
      "parentUuid": "6e379257_dfcc1ea0",
      "revId": "7c859a4b3813028d088a972b45c867337065a86b",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "5d59ad05_270dc8c8",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/replication/MergedConfigResource.java",
        "patchSetId": 6
      },
      "lineNbr": 54,
      "author": {
        "id": 1003873
      },
      "writtenOn": "2024-02-12T15:04:01Z",
      "side": 1,
      "message": "This check is unnecessary because this line is unreachable when `overrides \u003d\u003d null` in which case this method exits at the line 51.",
      "revId": "7c859a4b3813028d088a972b45c867337065a86b",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "6e6c26fc_2e73174c",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/replication/MergedConfigResource.java",
        "patchSetId": 6
      },
      "lineNbr": 54,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2024-04-02T13:28:01Z",
      "side": 1,
      "message": "Acknowledged",
      "parentUuid": "5d59ad05_270dc8c8",
      "revId": "7c859a4b3813028d088a972b45c867337065a86b",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "3af14be1_54d2c350",
        "filename": "src/main/resources/Documentation/extension-point.md",
        "patchSetId": 6
      },
      "lineNbr": 0,
      "author": {
        "id": 1010134
      },
      "writtenOn": "2024-02-12T15:39:11Z",
      "side": 1,
      "message": "documentation needs to be updated to include the new building steps.",
      "revId": "7c859a4b3813028d088a972b45c867337065a86b",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    }
  ]
}