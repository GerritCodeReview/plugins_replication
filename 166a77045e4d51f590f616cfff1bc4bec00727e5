{
  "comments": [
    {
      "key": {
        "uuid": "QzJbzjCs",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/replication/Destination.java",
        "patchSetId": 3
      },
      "lineNbr": 63,
      "author": {
        "id": 1001240
      },
      "writtenOn": "2013-03-05T17:16:16Z",
      "side": 1,
      "message": "Move this type into class Destination. It probably doesn\u0027t need to be public either.",
      "revId": "166a77045e4d51f590f616cfff1bc4bec00727e5",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "Q45-uE0I",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/replication/Destination.java",
        "patchSetId": 3
      },
      "lineNbr": 63,
      "author": {
        "id": 1012098
      },
      "writtenOn": "2013-03-05T19:49:12Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "QzJbzjCs",
      "revId": "166a77045e4d51f590f616cfff1bc4bec00727e5",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "QzPb4AAk",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/replication/Destination.java",
        "patchSetId": 3
      },
      "lineNbr": 347,
      "author": {
        "id": 1001240
      },
      "writtenOn": "2013-03-05T17:16:16Z",
      "side": 1,
      "message": "use inflight.containsKey(op.getURI()) instead of !\u003d null",
      "revId": "166a77045e4d51f590f616cfff1bc4bec00727e5",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "QzHYNEEQ",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/replication/Destination.java",
        "patchSetId": 3
      },
      "lineNbr": 347,
      "author": {
        "id": 1003883
      },
      "writtenOn": "2013-03-05T18:28:44Z",
      "side": 1,
      "message": "Hmm, is there anyway we can actually confirm that things are inflight?  What if some unexpected exception happens in the completion path and an entry never gets removed from the inflight map, will it then block new entries for the URI indefinitely?  Perhaps we need to build in a timeout to being in the inflight queue?",
      "parentUuid": "QzPb4AAk",
      "revId": "166a77045e4d51f590f616cfff1bc4bec00727e5",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "QzLYV6E0",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/replication/Destination.java",
        "patchSetId": 3
      },
      "lineNbr": 347,
      "author": {
        "id": 1001240
      },
      "writtenOn": "2013-03-05T18:30:06Z",
      "side": 1,
      "message": "Removal from inFlight is done by notifyFinished in a finally block. If the JVM can avoid calling that... the JVM is corrupt and needs to die and be restarted. :-)",
      "parentUuid": "QzHYNEEQ",
      "revId": "166a77045e4d51f590f616cfff1bc4bec00727e5",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "QzPYPYDc",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/replication/Destination.java",
        "patchSetId": 3
      },
      "lineNbr": 347,
      "author": {
        "id": 1003883
      },
      "writtenOn": "2013-03-05T18:45:31Z",
      "side": 1,
      "message": "OK, I admit I am paranoid.  Should the call to this function be put in the try for that finally too then so that other weird JVM runtime exceptions will be caught (and the !cancelled on line 208 of PushOne)?",
      "parentUuid": "QzLYV6E0",
      "revId": "166a77045e4d51f590f616cfff1bc4bec00727e5",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "QzDYqeIw",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/replication/Destination.java",
        "patchSetId": 3
      },
      "lineNbr": 347,
      "author": {
        "id": 1001240
      },
      "writtenOn": "2013-03-05T18:46:37Z",
      "side": 1,
      "message": "!cancelled cannot fail if cancelled is a primitive. If it does, the JVM or the CPU needs to be taken out of service.",
      "revId": "166a77045e4d51f590f616cfff1bc4bec00727e5",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "Q5J7uHUI",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/replication/Destination.java",
        "patchSetId": 3
      },
      "lineNbr": 347,
      "author": {
        "id": 1003883
      },
      "writtenOn": "2013-03-05T19:47:04Z",
      "side": 1,
      "message": "Not quite what I meant.  I assume if we are checking !cancelled, it can sometimes actually be cancelled.  It isn\u0027t obvious to me that the entry is being removed from inFlight in those cases?",
      "parentUuid": "QzDYqeIw",
      "revId": "166a77045e4d51f590f616cfff1bc4bec00727e5",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "Q47-z1yo",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/replication/Destination.java",
        "patchSetId": 3
      },
      "lineNbr": 347,
      "author": {
        "id": 1012098
      },
      "writtenOn": "2013-03-05T19:49:12Z",
      "side": 1,
      "message": "What Shawn said.\n\nI switched to inflight.containsKey()",
      "parentUuid": "QzDYqeIw",
      "revId": "166a77045e4d51f590f616cfff1bc4bec00727e5",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "Q4x8D4xs",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/replication/Destination.java",
        "patchSetId": 3
      },
      "lineNbr": 347,
      "author": {
        "id": 1012098
      },
      "writtenOn": "2013-03-05T19:53:02Z",
      "side": 1,
      "message": "If an op is cancelled, it should never get into inFlight.  It can only be marked \u0027cancelled\u0027 while it\u0027s in the pending queue.",
      "parentUuid": "Q5J7uHUI",
      "revId": "166a77045e4d51f590f616cfff1bc4bec00727e5",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "Q5N74pQk",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/replication/Destination.java",
        "patchSetId": 3
      },
      "lineNbr": 347,
      "author": {
        "id": 1003883
      },
      "writtenOn": "2013-03-05T20:10:28Z",
      "side": 1,
      "message": "Is there a synchronized(state_lock) around that cancel, I can\u0027t find it?",
      "parentUuid": "Q4x8D4xs",
      "revId": "166a77045e4d51f590f616cfff1bc4bec00727e5",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "QzNb9BPc",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/replication/PushOne.java",
        "patchSetId": 3
      },
      "lineNbr": 199,
      "author": {
        "id": 1001240
      },
      "writtenOn": "2013-03-05T17:16:16Z",
      "side": 1,
      "message": "if (!pool.requestRunway(this))",
      "revId": "166a77045e4d51f590f616cfff1bc4bec00727e5",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "Q49-4mwk",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/replication/PushOne.java",
        "patchSetId": 3
      },
      "lineNbr": 199,
      "author": {
        "id": 1012098
      },
      "writtenOn": "2013-03-05T19:49:12Z",
      "side": 1,
      "message": "I have been writing python for too long.\n\nDone.",
      "parentUuid": "QzNb9BPc",
      "revId": "166a77045e4d51f590f616cfff1bc4bec00727e5",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    }
  ]
}