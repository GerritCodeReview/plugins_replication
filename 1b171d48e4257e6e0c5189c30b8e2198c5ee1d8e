{
  "comments": [
    {
      "key": {
        "uuid": "b8c61c15_1bd4f3c0",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1002666
      },
      "writtenOn": "2020-09-02T17:01:03Z",
      "side": 1,
      "message": "$ bazel test  --runs_per_test\u003d10  --nocache_test_results  --test_filter\u003dcom.googlesource.gerrit.plugins.replication.ReplicationIT ...\nINFO: Invocation ID: 9d59cf7f-cfcf-4df3-b8e0-f21e14b7a00c\nINFO: Analyzed target //plugins/replication:replication_tests (0 packages loaded, 0 targets configured).\nINFO: Found 1 test target...\nTarget //plugins/replication:replication_tests up-to-date:\n  bazel-bin/plugins/replication/replication_tests.jar\n  bazel-bin/plugins/replication/replication_tests\nINFO: Elapsed time: 660.505s, Critical Path: 227.37s\nINFO: 16 processes: 13 darwin-sandbox, 3 worker.\nINFO: Build completed successfully, 17 total actions\n//plugins/replication:replication_tests                                  PASSED in 223.9s\n  Stats over 10 runs: max \u003d 223.9s, min \u003d 215.0s, avg \u003d 219.1s, dev \u003d 3.0s\n\nINFO: Build completed successfully, 17 total actions\n\n\n$ bazel test  --runs_per_test\u003d10  --nocache_test_results  --test_filter\u003dcom.googlesource.gerrit.plugins.replication.ReplicationFanoutIT ...\nINFO: Invocation ID: d7ac46dc-91d3-48b2-a11c-e2908de1af7c\nINFO: Build option --test_filter has changed, discarding analysis cache.\nINFO: Analyzed target //plugins/replication:replication_tests (0 packages loaded, 5415 targets configured).\nINFO: Found 1 test target...\nTarget //plugins/replication:replication_tests up-to-date:\n  bazel-bin/plugins/replication/replication_tests.jar\n  bazel-bin/plugins/replication/replication_tests\nINFO: Elapsed time: 60.864s, Critical Path: 24.75s\nINFO: 10 processes: 10 darwin-sandbox.\nINFO: Build completed successfully, 11 total actions\n//plugins/replication:replication_tests                                  PASSED in 24.4s\n  Stats over 10 runs: max \u003d 24.4s, min \u003d 16.7s, avg \u003d 20.6s, dev \u003d 2.8s\n\nExecuted 1 out of 1 test: 1 test passes.\nINFO: Build completed successfully, 11 total actions",
      "revId": "1b171d48e4257e6e0c5189c30b8e2198c5ee1d8e",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "51361463_9a00e0d1",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2020-09-02T18:36:10Z",
      "side": 1,
      "message": "The synchronized was introduced to fix the tests flakiness. I am fine in removing it but we need to make sure that the tests are stable and not flaky anymore.",
      "revId": "1b171d48e4257e6e0c5189c30b8e2198c5ee1d8e",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "01504112_cad5c424",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1002666
      },
      "writtenOn": "2020-09-02T18:56:07Z",
      "side": 1,
      "message": "What would you recommend doing to test for that beyond the results I already posted?",
      "parentUuid": "51361463_9a00e0d1",
      "revId": "1b171d48e4257e6e0c5189c30b8e2198c5ee1d8e",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "ac49580a_8de3cf0c",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2020-09-02T19:32:01Z",
      "side": 1,
      "message": "I believe 10 runs aren\u0027t enough, also depends on how many cores your system has.\nI am running now on my laptop with 16 cores, 50 runs. Will post the results shortly.\n\nBear in mind that the replication plugin tests are executed together with the main Gerrit build, because this is a core plugin. Reintroducing flakiness would make the entire Gerrit build flaky again :-(",
      "parentUuid": "01504112_cad5c424",
      "revId": "1b171d48e4257e6e0c5189c30b8e2198c5ee1d8e",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "724d31f1_26b6c155",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1002666
      },
      "writtenOn": "2020-09-02T19:57:55Z",
      "side": 1,
      "message": "$ bazel test  --runs_per_test\u003d50  --nocache_test_results  ...\nINFO: Invocation ID: cd596eda-e390-4605-91d0-d3cd6196c872\nINFO: Build options --runs_per_test and --test_filter have changed, discarding analysis cache.\nINFO: Analyzed target //plugins/replication:replication_tests (0 packages loaded, 5413 targets configured).\nINFO: Found 1 test target...\nTarget //plugins/replication:replication_tests up-to-date:\n  bazel-bin/plugins/replication/replication_tests.jar\n  bazel-bin/plugins/replication/replication_tests\nINFO: Elapsed time: 3107.283s, Critical Path: 250.07s\nINFO: 50 processes: 50 darwin-sandbox.\nINFO: Build completed successfully, 51 total actions\n//plugins/replication:replication_tests                                  PASSED in 249.6s\n  Stats over 50 runs: max \u003d 249.6s, min \u003d 233.1s, avg \u003d 239.1s, dev \u003d 3.5s\n\nINFO: Build completed successfully, 51 total actions\n\nThat\u0027s 50 runs, 4 in parallel at a time. I\u0027m running again with all cores going (16 as well). I can run it on a bigger machine with more cores if you think that would make a difference.",
      "parentUuid": "ac49580a_8de3cf0c",
      "revId": "1b171d48e4257e6e0c5189c30b8e2198c5ee1d8e",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "b9a65c68_8a993383",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/replication/ReplicationTasksStorage.java",
        "patchSetId": 1
      },
      "lineNbr": 167,
      "author": {
        "id": 1003883
      },
      "writtenOn": "2020-09-02T18:25:03Z",
      "side": 1,
      "message": "if you remove the synchronized I think you will need to catch DirectoryIteratorException here .",
      "range": {
        "startLine": 167,
        "startChar": 4,
        "endLine": 167,
        "endChar": 6
      },
      "revId": "1b171d48e4257e6e0c5189c30b8e2198c5ee1d8e",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "f12cb0b3_8fa4b570",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/replication/ReplicationTasksStorage.java",
        "patchSetId": 1
      },
      "lineNbr": 167,
      "author": {
        "id": 1002666
      },
      "writtenOn": "2020-09-02T18:56:07Z",
      "side": 1,
      "message": "I don\u0027t think so. That exception would only occur if someone removed a top-level dir (like waiting/ or running/), i.e. if the Path \u0027tasks\u0027 was removed. Someone could force that to happen artificially (the code never does it), but it\u0027s not a new case exposed by lack of synchronized.",
      "parentUuid": "b9a65c68_8a993383",
      "range": {
        "startLine": 167,
        "startChar": 4,
        "endLine": 167,
        "endChar": 6
      },
      "revId": "1b171d48e4257e6e0c5189c30b8e2198c5ee1d8e",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "df4a89e6_44f09ec5",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/replication/ReplicationTasksStorage.java",
        "patchSetId": 1
      },
      "lineNbr": 167,
      "author": {
        "id": 1003883
      },
      "writtenOn": "2020-09-02T19:03:14Z",
      "side": 1,
      "message": "Ack",
      "parentUuid": "f12cb0b3_8fa4b570",
      "range": {
        "startLine": 167,
        "startChar": 4,
        "endLine": 167,
        "endChar": 6
      },
      "revId": "1b171d48e4257e6e0c5189c30b8e2198c5ee1d8e",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    }
  ]
}