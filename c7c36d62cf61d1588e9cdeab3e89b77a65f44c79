{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "569356ba_0c8f364e",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2023-11-24T01:04:10Z",
      "side": 1,
      "message": "Approving, we have the equivalent change also on the pull-replication plugin.",
      "revId": "c7c36d62cf61d1588e9cdeab3e89b77a65f44c79",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "f9aed6f7_5c06661a",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/replication/ReplicationQueue.java",
        "patchSetId": 2
      },
      "lineNbr": 307,
      "author": {
        "id": 1002666
      },
      "writtenOn": "2023-11-17T00:10:19Z",
      "side": 1,
      "message": "Hmm, is this racy? i.e. if someone triggers a reload after `poll()` but before `fire()`, do we lose the event?\n\nIf yes, we do have a concurrent queue here, so I think it would be safe to get an iterator and remove from the queue after firing.",
      "revId": "c7c36d62cf61d1588e9cdeab3e89b77a65f44c79",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "619ce09f_0bf5ac10",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/replication/ReplicationQueue.java",
        "patchSetId": 2
      },
      "lineNbr": 307,
      "author": {
        "id": 1161425
      },
      "writtenOn": "2023-11-21T08:32:57Z",
      "side": 1,
      "message": "Thank you Nasser, in case the plugin is restarted before `fire()`, the queue will obviously become empty, losing the event.\n\nWhen the plugin is reloaded instead, as you say we could lose the event if that happens between the `poll()` and the `fire()`, on the other hand, if the plugin is constantly being reloaded, we might end up in a situation where the event is finally `fired` at a much later time than it was intended to, actually causing to possibly send an old ref value.\nWDYT?",
      "parentUuid": "f9aed6f7_5c06661a",
      "revId": "c7c36d62cf61d1588e9cdeab3e89b77a65f44c79",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "8108dec9_55fe87a5",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/replication/ReplicationQueue.java",
        "patchSetId": 2
      },
      "lineNbr": 307,
      "author": {
        "id": 1161425
      },
      "writtenOn": "2023-11-23T21:57:18Z",
      "side": 1,
      "message": "@nasser.grainawi@linaro.org any thoughts on this comment?",
      "parentUuid": "619ce09f_0bf5ac10",
      "revId": "c7c36d62cf61d1588e9cdeab3e89b77a65f44c79",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "9837d329_6cf5bcda",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/replication/ReplicationQueue.java",
        "patchSetId": 2
      },
      "lineNbr": 307,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2023-11-24T01:05:06Z",
      "side": 1,
      "message": "\u003e @nasser.grainawi@linaro.org any thoughts on this comment?\n\nMy 2c: if the plugin is reloaded, the in-memory data is lost anyway. So, even if we keep the element in the queue, the reloaded plugin will start with an empty memory area.",
      "parentUuid": "8108dec9_55fe87a5",
      "revId": "c7c36d62cf61d1588e9cdeab3e89b77a65f44c79",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "1b62f2d4_ce9a0a3e",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/replication/ReplicationQueue.java",
        "patchSetId": 2
      },
      "lineNbr": 307,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2023-11-25T00:21:39Z",
      "side": 1,
      "message": "Acknowledged",
      "parentUuid": "9837d329_6cf5bcda",
      "revId": "c7c36d62cf61d1588e9cdeab3e89b77a65f44c79",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "5b97780f_7d1880df",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/replication/ReplicationQueue.java",
        "patchSetId": 2
      },
      "lineNbr": 308,
      "author": {
        "id": 1002666
      },
      "writtenOn": "2023-11-17T00:10:19Z",
      "side": 1,
      "message": "Not related to your code, but I noticed that we\u0027re creating a key that\u0027s nearly identical to the AutoValue `ReferencesUpdatedEvent` class. Isn\u0027t the whole point of AutoValue that we can use it directly in a case like this?",
      "range": {
        "startLine": 308,
        "startChar": 13,
        "endLine": 308,
        "endChar": 21
      },
      "revId": "c7c36d62cf61d1588e9cdeab3e89b77a65f44c79",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    }
  ]
}