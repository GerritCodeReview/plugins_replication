{
  "comments": [
    {
      "key": {
        "uuid": "271171e9_f4a36b89",
        "filename": "/COMMIT_MSG",
        "patchSetId": 1
      },
      "lineNbr": 7,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2020-09-24T21:19:05Z",
      "side": 1,
      "message": "What is a multi-primary?",
      "range": {
        "startLine": 7,
        "startChar": 10,
        "endLine": 7,
        "endChar": 23
      },
      "revId": "8657a71f53444a9aa49331b67fbf2e169f09f398",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "8c764682_5b323ee3",
        "filename": "/COMMIT_MSG",
        "patchSetId": 1
      },
      "lineNbr": 7,
      "author": {
        "id": 1003883
      },
      "writtenOn": "2020-09-24T22:43:26Z",
      "side": 1,
      "message": "This is new new language, primaries and replicas.",
      "parentUuid": "271171e9_f4a36b89",
      "range": {
        "startLine": 7,
        "startChar": 10,
        "endLine": 7,
        "endChar": 23
      },
      "revId": "8657a71f53444a9aa49331b67fbf2e169f09f398",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "61ef51ef_e18073d1",
        "filename": "/COMMIT_MSG",
        "patchSetId": 1
      },
      "lineNbr": 9,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2020-09-24T21:19:05Z",
      "side": 1,
      "message": "I would just start the phrase with: \"When two different Gerrit servers ...\"",
      "range": {
        "startLine": 9,
        "startChar": 0,
        "endLine": 9,
        "endChar": 40
      },
      "revId": "8657a71f53444a9aa49331b67fbf2e169f09f398",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "512996ed_87d9b8ee",
        "filename": "/COMMIT_MSG",
        "patchSetId": 1
      },
      "lineNbr": 9,
      "author": {
        "id": 1003883
      },
      "writtenOn": "2020-09-24T22:43:26Z",
      "side": 1,
      "message": "I think multi-primary would be more consistent with the new consensus on terms?",
      "parentUuid": "61ef51ef_e18073d1",
      "range": {
        "startLine": 9,
        "startChar": 0,
        "endLine": 9,
        "endChar": 40
      },
      "revId": "8657a71f53444a9aa49331b67fbf2e169f09f398",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "af06ada9_dfa4e688",
        "filename": "/COMMIT_MSG",
        "patchSetId": 1
      },
      "lineNbr": 17,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2020-09-24T21:19:05Z",
      "side": 1,
      "message": "Bug: Issue 13441",
      "range": {
        "startLine": 17,
        "startChar": 0,
        "endLine": 17,
        "endChar": 16
      },
      "revId": "8657a71f53444a9aa49331b67fbf2e169f09f398",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "be02a262_fa9a854b",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2020-09-24T21:19:05Z",
      "side": 1,
      "message": "Thanks, Adithya, for creating this test. This is not a problem just for replication clustering scenarios but also for the single Gerrit server.",
      "revId": "8657a71f53444a9aa49331b67fbf2e169f09f398",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "338a9a38_c9933d72",
        "filename": "src/test/java/com/googlesource/gerrit/plugins/replication/ReplicationTasksStorageMPTest.java",
        "patchSetId": 1
      },
      "lineNbr": 35,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2020-09-24T21:19:05Z",
      "side": 1,
      "message": "import ReplicationTaskStorage.ReplicateRefUpdate, so that you can avoid repeating the full name  which would make the test more readable.",
      "range": {
        "startLine": 35,
        "startChar": 25,
        "endLine": 35,
        "endChar": 67
      },
      "revId": "8657a71f53444a9aa49331b67fbf2e169f09f398",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "3451a032_980a7d6e",
        "filename": "src/test/java/com/googlesource/gerrit/plugins/replication/ReplicationTasksStorageMPTest.java",
        "patchSetId": 1
      },
      "lineNbr": 51,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2020-09-24T21:19:05Z",
      "side": 1,
      "message": "How is this different than nodeA or nodeB?",
      "range": {
        "startLine": 51,
        "startChar": 4,
        "endLine": 51,
        "endChar": 61
      },
      "revId": "8657a71f53444a9aa49331b67fbf2e169f09f398",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "22819cc4_ef0b9b5b",
        "filename": "src/test/java/com/googlesource/gerrit/plugins/replication/ReplicationTasksStorageMPTest.java",
        "patchSetId": 1
      },
      "lineNbr": 51,
      "author": {
        "id": 1105741
      },
      "writtenOn": "2020-09-24T21:46:33Z",
      "side": 1,
      "message": "Offers persisted view of storage on which asserts are being done.",
      "parentUuid": "3451a032_980a7d6e",
      "range": {
        "startLine": 51,
        "startChar": 4,
        "endLine": 51,
        "endChar": 61
      },
      "revId": "8657a71f53444a9aa49331b67fbf2e169f09f398",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "0235194d_bbbf049c",
        "filename": "src/test/java/com/googlesource/gerrit/plugins/replication/ReplicationTasksStorageMPTest.java",
        "patchSetId": 1
      },
      "lineNbr": 51,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2020-09-24T22:04:03Z",
      "side": 1,
      "message": "The \"persisted view\" is just in its name, I do not see any difference with nodeA or nodeB. Can you clarify how it would give a different view (the persisted one) compared to nodeA or nodeB? I may be completely missing the point, if yes, I apologise in advance. If not, I would like to understand more about it.",
      "parentUuid": "22819cc4_ef0b9b5b",
      "range": {
        "startLine": 51,
        "startChar": 4,
        "endLine": 51,
        "endChar": 61
      },
      "revId": "8657a71f53444a9aa49331b67fbf2e169f09f398",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "77142503_1b8ac6c5",
        "filename": "src/test/java/com/googlesource/gerrit/plugins/replication/ReplicationTasksStorageMPTest.java",
        "patchSetId": 1
      },
      "lineNbr": 64,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2020-09-24T21:19:05Z",
      "side": 1,
      "message": "How is this different than REF_UPDATE? It looks identical to me, unless I am missing something.",
      "range": {
        "startLine": 64,
        "startChar": 47,
        "endLine": 64,
        "endChar": 62
      },
      "revId": "8657a71f53444a9aa49331b67fbf2e169f09f398",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "c9254fc6_4513ac49",
        "filename": "src/test/java/com/googlesource/gerrit/plugins/replication/ReplicationTasksStorageMPTest.java",
        "patchSetId": 1
      },
      "lineNbr": 64,
      "author": {
        "id": 1105741
      },
      "writtenOn": "2020-09-24T21:46:33Z",
      "side": 1,
      "message": "To show that it is being created later in time.",
      "parentUuid": "77142503_1b8ac6c5",
      "range": {
        "startLine": 64,
        "startChar": 47,
        "endLine": 64,
        "endChar": 62
      },
      "revId": "8657a71f53444a9aa49331b67fbf2e169f09f398",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "3a19e123_63481063",
        "filename": "src/test/java/com/googlesource/gerrit/plugins/replication/ReplicationTasksStorageMPTest.java",
        "patchSetId": 1
      },
      "lineNbr": 64,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2020-09-24T22:04:03Z",
      "side": 1,
      "message": "The creation of the in-memory object does not make any difference if done earlier or later.\n\nSee the constructor code below:\n\n    public ReplicateRefUpdate(String project, String ref, URIish uri, String remote) {\n      this.project \u003d project;\n      this.ref \u003d ref;\n      this.uri \u003d uri.toASCIIString();\n      this.remote \u003d remote;\n    }\n\nAren\u0027t you confusing the creation of the in-memory object with the creation of the underlying persistent file on the filesystem? That is done at L69 and that makes sense done after the nodeA.create(REF_UPDATE).",
      "parentUuid": "c9254fc6_4513ac49",
      "range": {
        "startLine": 64,
        "startChar": 47,
        "endLine": 64,
        "endChar": 62
      },
      "revId": "8657a71f53444a9aa49331b67fbf2e169f09f398",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "8a3a4560_19b2de0c",
        "filename": "src/test/java/com/googlesource/gerrit/plugins/replication/ReplicationTasksStorageMPTest.java",
        "patchSetId": 1
      },
      "lineNbr": 64,
      "author": {
        "id": 1003883
      },
      "writtenOn": "2020-09-24T22:43:26Z",
      "side": 1,
      "message": "The objective of the variable is to show intent, not to be functionally different. Think of the following example:  \n\n TEST_REPLICATION_DELAY \u003d1\n TEST_RETRY_DELAY \u003d1\n\nAlthough those variables contain the same thing, their intent is different. The SECOND_REF_UPDATE is created on line 69. This simulates how the plugin will use this API and it this test whether this usage works or not, without the need to know about how the data is stored (memory, filesystem...).",
      "parentUuid": "3a19e123_63481063",
      "range": {
        "startLine": 64,
        "startChar": 47,
        "endLine": 64,
        "endChar": 62
      },
      "revId": "8657a71f53444a9aa49331b67fbf2e169f09f398",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "e6325d63_16694e44",
        "filename": "src/test/java/com/googlesource/gerrit/plugins/replication/ReplicationTasksStorageMPTest.java",
        "patchSetId": 1
      },
      "lineNbr": 66,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2020-09-24T21:19:05Z",
      "side": 1,
      "message": "This looks also identical to URI_UPDATE",
      "range": {
        "startLine": 66,
        "startChar": 15,
        "endLine": 66,
        "endChar": 30
      },
      "revId": "8657a71f53444a9aa49331b67fbf2e169f09f398",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "c9d84b25_f98f3848",
        "filename": "src/test/java/com/googlesource/gerrit/plugins/replication/ReplicationTasksStorageMPTest.java",
        "patchSetId": 1
      },
      "lineNbr": 66,
      "author": {
        "id": 1105741
      },
      "writtenOn": "2020-09-24T21:46:33Z",
      "side": 1,
      "message": "same as above",
      "parentUuid": "e6325d63_16694e44",
      "range": {
        "startLine": 66,
        "startChar": 15,
        "endLine": 66,
        "endChar": 30
      },
      "revId": "8657a71f53444a9aa49331b67fbf2e169f09f398",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "d9b0add6_0d8939e2",
        "filename": "src/test/java/com/googlesource/gerrit/plugins/replication/ReplicationTasksStorageMPTest.java",
        "patchSetId": 1
      },
      "lineNbr": 66,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2020-09-24T22:04:03Z",
      "side": 1,
      "message": "Yep, same comment as above.",
      "parentUuid": "c9d84b25_f98f3848",
      "range": {
        "startLine": 66,
        "startChar": 15,
        "endLine": 66,
        "endChar": 30
      },
      "revId": "8657a71f53444a9aa49331b67fbf2e169f09f398",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "5b2cbabe_e51b006f",
        "filename": "src/test/java/com/googlesource/gerrit/plugins/replication/ReplicationTasksStorageMPTest.java",
        "patchSetId": 1
      },
      "lineNbr": 66,
      "author": {
        "id": 1003883
      },
      "writtenOn": "2020-09-24T22:43:26Z",
      "side": 1,
      "message": "See above.",
      "parentUuid": "d9b0add6_0d8939e2",
      "range": {
        "startLine": 66,
        "startChar": 15,
        "endLine": 66,
        "endChar": 30
      },
      "revId": "8657a71f53444a9aa49331b67fbf2e169f09f398",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "4677bf5c_3c5d347d",
        "filename": "src/test/java/com/googlesource/gerrit/plugins/replication/ReplicationTasksStorageMPTest.java",
        "patchSetId": 1
      },
      "lineNbr": 68,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2020-09-24T21:19:05Z",
      "side": 1,
      "message": "This resets the task URI_UPDATE that is running on nodeA, correct?",
      "range": {
        "startLine": 68,
        "startChar": 10,
        "endLine": 68,
        "endChar": 21
      },
      "revId": "8657a71f53444a9aa49331b67fbf2e169f09f398",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "7e58edce_47999288",
        "filename": "src/test/java/com/googlesource/gerrit/plugins/replication/ReplicationTasksStorageMPTest.java",
        "patchSetId": 1
      },
      "lineNbr": 68,
      "author": {
        "id": 1105741
      },
      "writtenOn": "2020-09-24T21:46:33Z",
      "side": 1,
      "message": "Yes",
      "parentUuid": "4677bf5c_3c5d347d",
      "range": {
        "startLine": 68,
        "startChar": 10,
        "endLine": 68,
        "endChar": 21
      },
      "revId": "8657a71f53444a9aa49331b67fbf2e169f09f398",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "c26af5a5_9ed754a4",
        "filename": "src/test/java/com/googlesource/gerrit/plugins/replication/ReplicationTasksStorageMPTest.java",
        "patchSetId": 1
      },
      "lineNbr": 68,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2020-09-24T22:04:03Z",
      "side": 1,
      "message": "Cool, possibly a comment would help the reader :-)",
      "parentUuid": "7e58edce_47999288",
      "range": {
        "startLine": 68,
        "startChar": 10,
        "endLine": 68,
        "endChar": 21
      },
      "revId": "8657a71f53444a9aa49331b67fbf2e169f09f398",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "61ae2075_16d81e95",
        "filename": "src/test/java/com/googlesource/gerrit/plugins/replication/ReplicationTasksStorageMPTest.java",
        "patchSetId": 1
      },
      "lineNbr": 72,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2020-09-24T21:19:05Z",
      "side": 1,
      "message": "And this one finishes the task that is running on nodeB, correct?",
      "range": {
        "startLine": 72,
        "startChar": 9,
        "endLine": 72,
        "endChar": 29
      },
      "revId": "8657a71f53444a9aa49331b67fbf2e169f09f398",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "1fb1f543_3d7bbd55",
        "filename": "src/test/java/com/googlesource/gerrit/plugins/replication/ReplicationTasksStorageMPTest.java",
        "patchSetId": 1
      },
      "lineNbr": 72,
      "author": {
        "id": 1105741
      },
      "writtenOn": "2020-09-24T21:46:33Z",
      "side": 1,
      "message": "Yes",
      "parentUuid": "61ae2075_16d81e95",
      "range": {
        "startLine": 72,
        "startChar": 9,
        "endLine": 72,
        "endChar": 29
      },
      "revId": "8657a71f53444a9aa49331b67fbf2e169f09f398",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "3ac9cd2e_d28c4421",
        "filename": "src/test/java/com/googlesource/gerrit/plugins/replication/ReplicationTasksStorageMPTest.java",
        "patchSetId": 1
      },
      "lineNbr": 72,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2020-09-24T22:04:03Z",
      "side": 1,
      "message": "As above: a comment would be helpful for the reader to understand the scenario you are creating.",
      "parentUuid": "1fb1f543_3d7bbd55",
      "range": {
        "startLine": 72,
        "startChar": 9,
        "endLine": 72,
        "endChar": 29
      },
      "revId": "8657a71f53444a9aa49331b67fbf2e169f09f398",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "d231ecfc_d21be3ff",
        "filename": "src/test/java/com/googlesource/gerrit/plugins/replication/ReplicationTasksStorageMPTest.java",
        "patchSetId": 1
      },
      "lineNbr": 72,
      "author": {
        "id": 1003883
      },
      "writtenOn": "2020-09-24T22:43:26Z",
      "side": 1,
      "message": "Such a comment would need to be removed once it is fixed since although you are correct, that is part of the problematic implementaion that needs to be fixed.",
      "parentUuid": "3ac9cd2e_d28c4421",
      "range": {
        "startLine": 72,
        "startChar": 9,
        "endLine": 72,
        "endChar": 29
      },
      "revId": "8657a71f53444a9aa49331b67fbf2e169f09f398",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "11455a07_93f5a70f",
        "filename": "src/test/java/com/googlesource/gerrit/plugins/replication/ReplicationTasksStorageMPTest.java",
        "patchSetId": 1
      },
      "lineNbr": 75,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2020-09-24T21:19:05Z",
      "side": 1,
      "message": "The point here is that we are missing the value of the SHA1 that is getting pushed. If the two events were trying to push the *same* SHA1, then losing one of the two isn\u0027t a problem, as the SHA1 gets pushed anyway.\n\nAt the moment, the primary key of the replication task is:\nURI + repo + ref + remote\n\nIf we have two replication events for *two* SHA1s (it may happen, in heavily loaded environments) then one of the two events is lost, because they go in conflict with the same key.",
      "range": {
        "startLine": 75,
        "startChar": 55,
        "endLine": 75,
        "endChar": 70
      },
      "revId": "8657a71f53444a9aa49331b67fbf2e169f09f398",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    }
  ]
}