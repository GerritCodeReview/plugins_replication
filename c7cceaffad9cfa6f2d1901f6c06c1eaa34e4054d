{
  "comments": [
    {
      "key": {
        "uuid": "a3a70f9c_7f318d89",
        "filename": "/COMMIT_MSG",
        "patchSetId": 1
      },
      "lineNbr": 7,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2020-08-10T22:13:21Z",
      "side": 1,
      "message": "missed during merge?",
      "range": {
        "startLine": 7,
        "startChar": 30,
        "endLine": 7,
        "endChar": 48
      },
      "revId": "c7cceaffad9cfa6f2d1901f6c06c1eaa34e4054d",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "d39869b1_ef5a0f98",
        "filename": "/COMMIT_MSG",
        "patchSetId": 1
      },
      "lineNbr": 7,
      "author": {
        "id": 1002666
      },
      "writtenOn": "2020-08-10T22:23:15Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "a3a70f9c_7f318d89",
      "range": {
        "startLine": 7,
        "startChar": 30,
        "endLine": 7,
        "endChar": 48
      },
      "revId": "c7cceaffad9cfa6f2d1901f6c06c1eaa34e4054d",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "823b32bc_2f780aac",
        "filename": "/COMMIT_MSG",
        "patchSetId": 1
      },
      "lineNbr": 8,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2020-08-10T22:13:21Z",
      "side": 1,
      "message": "I would add some sentence for giving the context:\n\"During the merge of branch XYZ the delete() method removal\nwas missed. The unused method was not noticed because still\nreferenced by tests, that are now obsolete\"",
      "revId": "c7cceaffad9cfa6f2d1901f6c06c1eaa34e4054d",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "a58497d2_df8eab9d",
        "filename": "/COMMIT_MSG",
        "patchSetId": 1
      },
      "lineNbr": 8,
      "author": {
        "id": 1002666
      },
      "writtenOn": "2020-08-10T22:23:15Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "823b32bc_2f780aac",
      "revId": "c7cceaffad9cfa6f2d1901f6c06c1eaa34e4054d",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "ad9893c6_047e600c",
        "filename": "/COMMIT_MSG",
        "patchSetId": 1
      },
      "lineNbr": 9,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2020-08-05T22:56:41Z",
      "side": 1,
      "message": "nit: use imperative form.",
      "range": {
        "startLine": 9,
        "startChar": 11,
        "endLine": 9,
        "endChar": 23
      },
      "revId": "c7cceaffad9cfa6f2d1901f6c06c1eaa34e4054d",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "26f1179a_7a4c7923",
        "filename": "/COMMIT_MSG",
        "patchSetId": 1
      },
      "lineNbr": 9,
      "author": {
        "id": 1002666
      },
      "writtenOn": "2020-08-10T22:23:15Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "ad9893c6_047e600c",
      "range": {
        "startLine": 9,
        "startChar": 11,
        "endLine": 9,
        "endChar": 23
      },
      "revId": "c7cceaffad9cfa6f2d1901f6c06c1eaa34e4054d",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "b7ca5135_16cc01cc",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2020-08-05T22:56:41Z",
      "side": 1,
      "message": "I agree with you in general that we should not have code that is meant to be used just for testing. In this case, however, the cost of not having 3 lines of code for exposing a piece of code that is used anyway resulted in 52 extra lines of code that would not be needed.\n\nBottom line: it is best to have 3 lines of overhead rather than 52 lines of overhead, IMHO.\nHowever, I am open to challenges on the above :-)",
      "revId": "c7cceaffad9cfa6f2d1901f6c06c1eaa34e4054d",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "d1ee7408_e2db92a2",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1003883
      },
      "writtenOn": "2020-08-06T16:25:50Z",
      "side": 1,
      "message": "Currently the 3.1 code is not testing the use cases and APIs that the replication plugin uses in 3.1. This change (and likely even more) should have been done in the merge to 3.1 as the APIs have changed in 3.1. The tests before this change reflect the 2.16 API and not the way the 3.1 API is designed. This is a problem as the tests now do not help test the code paths that the plugin will actually use in real use cases. This miss-alignment happened because the delete() method was not removed from the code base even though is it no longer a part of the API and the tests were able to pass even though the API changed. This highlights how leaving unused code around only for testing is detrimental as it allows tests that should no longer pass to continue to pass. This approach to trying to save 49 lines of code in tests is the equivalent of saying \"let\u0027s save test code by removing tests\".",
      "parentUuid": "b7ca5135_16cc01cc",
      "revId": "c7cceaffad9cfa6f2d1901f6c06c1eaa34e4054d",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "28c6dcfe_5ed8965d",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2020-08-06T16:38:09Z",
      "side": 1,
      "message": "\u003e Currently the 3.1 code is not testing the use cases and APIs that the replication plugin uses in 3.1. This change (and likely even more) should have been done in the merge to 3.1 as the APIs have changed in 3.1. The tests before this change reflect the 2.16 API and not the way the 3.1 API is designed.\n\nBasically this is a delete \u003d\u003e finish translation needed because of the new v3.1 replication task storage design. Can we make this intent more explicit? Now it is clear to me, whilst previously it looked like just a cleanup + a refactoring, but now I get it.\n\n\u003e This is a problem as the tests now do not help test the code paths that the plugin will actually use in real use cases. This miss-alignment happened because the delete() method was not removed from the code base even though is it no longer a part of the API and the tests were able to pass even though the API changed.\n\nShould have been then part of the merge, as you said before?\nCan we possibly break it down into different concerns?\n1. Clean-up post merge by removing the delete() method and its associated references in tests, which are now dead code.\n2. Refactoring with the new test-cases\n\n\u003e This highlights how leaving unused code around only for testing is detrimental as it allows tests that should no longer pass to continue to pass.\n\nAgreed.\n\n\u003e This approach to trying to save 49 lines of code in tests is the equivalent of saying \"let\u0027s save test code by removing tests\".\n\nDead code should be removed, including tests.",
      "parentUuid": "d1ee7408_e2db92a2",
      "revId": "c7cceaffad9cfa6f2d1901f6c06c1eaa34e4054d",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "be44076d_60582c3d",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1002666
      },
      "writtenOn": "2020-08-10T20:51:42Z",
      "side": 1,
      "message": "\u003e \u003e Currently the 3.1 code is not testing the use cases and APIs that the replication plugin uses in 3.1. This change (and likely even more) should have been done in the merge to 3.1 as the APIs have changed in 3.1. The tests before this change reflect the 2.16 API and not the way the 3.1 API is designed.\n\u003e \n\u003e Basically this is a delete \u003d\u003e finish translation needed because of the new v3.1 replication task storage design.\n\nYes\n\n\u003e Can we make this intent more explicit? Now it is clear to me, whilst previously it looked like just a cleanup + a refactoring, but now I get it.\n\nI tried to do that in the commit message, but guess I missed something. Can you suggest what would make it clearer?\n\n\u003e \n\u003e \u003e This is a problem as the tests now do not help test the code paths that the plugin will actually use in real use cases. This miss-alignment happened because the delete() method was not removed from the code base even though is it no longer a part of the API and the tests were able to pass even though the API changed.\n\u003e \n\u003e Should have been then part of the merge, as you said before?\n\u003e Can we possibly break it down into different concerns?\n\u003e 1. Clean-up post merge by removing the delete() method and its associated references in tests, which are now dead code.\n\u003e 2. Refactoring with the new test-cases\n\nThis change is not adding any new test cases. It is only addressing #1.",
      "parentUuid": "28c6dcfe_5ed8965d",
      "revId": "c7cceaffad9cfa6f2d1901f6c06c1eaa34e4054d",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "948c775a_21db39b1",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2020-08-10T22:13:21Z",
      "side": 1,
      "message": "\u003e \u003e \u003e Currently the 3.1 code is not testing the use cases and APIs that the replication plugin uses in 3.1. This change (and likely even more) should have been done in the merge to 3.1 as the APIs have changed in 3.1. The tests before this change reflect the 2.16 API and not the way the 3.1 API is designed.\n\u003e \u003e \n\u003e \u003e Basically this is a delete \u003d\u003e finish translation needed because of the new v3.1 replication task storage design.\n\u003e \n\u003e Yes\n\u003e \n\u003e \u003e Can we make this intent more explicit? Now it is clear to me, whilst previously it looked like just a cleanup + a refactoring, but now I get it.\n\u003e \n\u003e I tried to do that in the commit message, but guess I missed something. Can you suggest what would make it clearer?\n\nDone, I added a suggested sentence for the commit message that would give more context.\n\n\u003e \u003e \u003e This is a problem as the tests now do not help test the code paths that the plugin will actually use in real use cases. This miss-alignment happened because the delete() method was not removed from the code base even though is it no longer a part of the API and the tests were able to pass even though the API changed.\n\u003e \u003e \n\u003e \u003e Should have been then part of the merge, as you said before?\n\u003e \u003e Can we possibly break it down into different concerns?\n\u003e \u003e 1. Clean-up post merge by removing the delete() method and its associated references in tests, which are now dead code.\n\u003e \u003e 2. Refactoring with the new test-cases\n\u003e \n\u003e This change is not adding any new test cases. It is only addressing #1.\n\nSee the introduction of UriUpdates in ReplicationTaskStorage.java:73",
      "parentUuid": "be44076d_60582c3d",
      "revId": "c7cceaffad9cfa6f2d1901f6c06c1eaa34e4054d",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "1da88f66_fb773c58",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1002666
      },
      "writtenOn": "2020-08-10T22:23:15Z",
      "side": 1,
      "message": "\u003e \u003e \u003e Can we possibly break it down into different concerns?\n\u003e \u003e \u003e 1. Clean-up post merge by removing the delete() method and its associated references in tests, which are now dead code.\n\u003e \u003e \u003e 2. Refactoring with the new test-cases\n\u003e \u003e \n\u003e \u003e This change is not adding any new test cases. It is only addressing #1.\n\u003e \n\u003e See the introduction of UriUpdates in ReplicationTaskStorage.java:73\n\nThat\u0027s not a new test. It\u0027s a helper interface to reduce duplicate code. I can upload this without it, but you end up with error prone code (I originally wrote this without it, in hindsight, I would have pushed so you could see the diff).",
      "parentUuid": "948c775a_21db39b1",
      "revId": "c7cceaffad9cfa6f2d1901f6c06c1eaa34e4054d",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "073b86c3_4d781a36",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2020-08-10T22:31:42Z",
      "side": 1,
      "message": "It is indeed a very useful refactoring that allows to test the start/finish more effectively. It goes beyond IMHO the scope of the headline: \"remove delete() missed during the merge\".\n\nRemoving a dead method and its associated tests is a valid objective for a change. Adding another test and refactoring the code to make it testable",
      "parentUuid": "1da88f66_fb773c58",
      "revId": "c7cceaffad9cfa6f2d1901f6c06c1eaa34e4054d",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "4c4381f3_01537434",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1002666
      },
      "writtenOn": "2020-08-10T22:35:29Z",
      "side": 1,
      "message": "\u003e It is indeed a very useful refactoring that allows to test the start/finish more effectively. It goes beyond IMHO the scope of the headline: \"remove delete() missed during the merge\".\n\u003e \n\u003e Removing a dead method and its associated tests is a valid objective for a change. Adding another test and refactoring the code to make it testable\n\nYou keep saying \"adding another test\". What test are you referring to?",
      "parentUuid": "073b86c3_4d781a36",
      "revId": "c7cceaffad9cfa6f2d1901f6c06c1eaa34e4054d",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "d35893a2_627129d4",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1002666
      },
      "writtenOn": "2020-08-10T22:39:39Z",
      "side": 1,
      "message": "\u003e \u003e It is indeed a very useful refactoring that allows to test the start/finish more effectively. It goes beyond IMHO the scope of the headline: \"remove delete() missed during the merge\".\n\u003e \u003e \n\u003e \u003e Removing a dead method and its associated tests is a valid objective for a change. Adding another test and refactoring the code to make it testable\n\u003e \n\u003e You keep saying \"adding another test\". What test are you referring to?\n\nAlso, to be clear, to keep the unit tests working without delete(), start() and finish() *must* have some refactoring done. The \"optional\" piece is the new interface.",
      "parentUuid": "4c4381f3_01537434",
      "revId": "c7cceaffad9cfa6f2d1901f6c06c1eaa34e4054d",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "30153622_920bb9b1",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2020-08-11T22:12:24Z",
      "side": 1,
      "message": "\u003e \u003e \u003e It is indeed a very useful refactoring that allows to test the start/finish more effectively. It goes beyond IMHO the scope of the headline: \"remove delete() missed during the merge\".\n\u003e \u003e \u003e \n\u003e \u003e \u003e Removing a dead method and its associated tests is a valid objective for a change. Adding another test and refactoring the code to make it testable\n\u003e \u003e \n\u003e \u003e You keep saying \"adding another test\". What test are you referring to?\n\u003e \n\u003e Also, to be clear, to keep the unit tests working without delete(), start() and finish() *must* have some refactoring done. The \"optional\" piece is the new interface.\n\nThe headline of the commit is \"TasksStorage: Remove delete() missed during merge\" hence I assumed that is the main purpose of the change. However, I see that the new test on the start/finish methods makes the bulk of the code change.\n\nI was expecting two changes instead:\n- removal of the delete() and the associated test (missed during the merge)\n- addition of the new start/finish methods with the associated refactoring needed to test it effectively.\n\nHope this clarifies.",
      "parentUuid": "d35893a2_627129d4",
      "revId": "c7cceaffad9cfa6f2d1901f6c06c1eaa34e4054d",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    }
  ]
}